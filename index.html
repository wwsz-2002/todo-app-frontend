<!DOCTYPE html>
<!-- æ–‡æ¡£ç±»å‹å£°æ˜ï¼Œå‘Šè¯‰æµè§ˆå™¨è¿™æ˜¯HTML5æ–‡æ¡£ -->
<html lang="zh-CN">
<head>
    <!-- å­—ç¬¦ç¼–ç è®¾ç½®ä¸ºUTF-8ï¼Œæ”¯æŒä¸­æ–‡æ˜¾ç¤º -->
    <meta charset="UTF-8">
    <!-- è§†å£è®¾ç½®ï¼Œç”¨äºå“åº”å¼è®¾è®¡ï¼Œç¡®ä¿åœ¨ä¸åŒè®¾å¤‡ä¸Šæ­£ç¡®æ˜¾ç¤º -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <title>ç°ä»£å¾…åŠäº‹é¡¹åº”ç”¨</title>
    <!-- å¼•å…¥å¤–éƒ¨CSSæ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- ä¸»å®¹å™¨ï¼Œé™åˆ¶æœ€å¤§å®½åº¦å¹¶å±…ä¸­æ˜¾ç¤º -->
    <div class="todo-container">
        <!-- å¤´éƒ¨åŒºåŸŸï¼Œæ˜¾ç¤ºåº”ç”¨æ ‡é¢˜ -->
        <header class="todo-header">
            <!-- æ ‡é¢˜ï¼Œæ·»åŠ äº†å¯çˆ±çš„ç¬”è®°æœ¬å›¾æ ‡ -->
            <h1>ğŸ“‹ å¾…åŠäº‹é¡¹</h1>
        </header>
        
        <!-- ä»»åŠ¡è¾“å…¥åŒºåŸŸï¼Œç”¨äºæ·»åŠ æ–°ä»»åŠ¡ -->
        <section class="todo-input-section">
            <!-- æ–‡æœ¬è¾“å…¥æ¡†ï¼Œç”¨äºè¾“å…¥ä»»åŠ¡å†…å®¹ -->
            <input type="text" id="task-input" placeholder="è¾“å…¥æ–°ä»»åŠ¡..." class="task-input">
            <!-- æ·»åŠ æŒ‰é’®ï¼Œç‚¹å‡»åæäº¤æ–°ä»»åŠ¡ -->
            <button id="add-task-btn" class="add-task-btn">æ·»åŠ </button>
        </section>
        
        <!-- ä»»åŠ¡åˆ—è¡¨åŒºåŸŸï¼Œæ˜¾ç¤ºæ‰€æœ‰å¾…åŠäº‹é¡¹ -->
        <section class="todo-list-section">
            <!-- æ— åºåˆ—è¡¨ï¼Œç”¨äºåŠ¨æ€ç”Ÿæˆä»»åŠ¡é¡¹ -->
            <ul id="todo-list" class="todo-list">
                <!-- ä»»åŠ¡é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </ul>
        </section>
        
        <!-- ä»»åŠ¡ç»Ÿè®¡åŒºåŸŸï¼Œæ˜¾ç¤ºä»»åŠ¡å®Œæˆæƒ…å†µ -->
        <footer class="todo-footer">
            <!-- ç»Ÿè®¡ä¿¡æ¯å®¹å™¨ -->
            <div id="task-stats" class="task-stats">
                <!-- åˆå§‹ç»Ÿè®¡ä¿¡æ¯ï¼Œå°†é€šè¿‡JavaScriptåŠ¨æ€æ›´æ–° -->
                å·²å®Œæˆ: 0 / æ€»ä»»åŠ¡: 0
            </div>
        </footer>
    </div>

    <script>
        /**
         * ä»»åŠ¡æ•°æ®ç®¡ç†æ¨¡å—
         * è´Ÿè´£å¤„ç†ä»»åŠ¡çš„CRUDæ“ä½œå’Œæœ¬åœ°å­˜å‚¨
         */
        const taskManager = {
            /**
             * è·å–æ‰€æœ‰ä»»åŠ¡
             * @returns {Array} ä»»åŠ¡æ•°ç»„
             */
            getTasks: function() {
                // ä»localStorageè·å–ä»»åŠ¡æ•°æ®
                const tasks = localStorage.getItem('todoTasks');
                // å¦‚æœæœ‰æ•°æ®ï¼Œè§£æä¸ºJavaScriptå¯¹è±¡ï¼›å¦åˆ™è¿”å›ç©ºæ•°ç»„
                return tasks ? JSON.parse(tasks) : [];
            },
            
            /**
             * ä¿å­˜ä»»åŠ¡åˆ°æœ¬åœ°å­˜å‚¨
             * @param {Array} tasks ä»»åŠ¡æ•°ç»„
             */
            saveTasks: function(tasks) {
                // å°†ä»»åŠ¡æ•°ç»„è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²å¹¶å­˜å‚¨åˆ°localStorage
                localStorage.setItem('todoTasks', JSON.stringify(tasks));
            },
            
            /**
             * æ·»åŠ æ–°ä»»åŠ¡
             * @param {string} text ä»»åŠ¡å†…å®¹
             * @returns {Object} æ–°åˆ›å»ºçš„ä»»åŠ¡å¯¹è±¡
             */
            addTask: function(text) {
                // è·å–ç°æœ‰ä»»åŠ¡
                const tasks = this.getTasks();
                // åˆ›å»ºæ–°ä»»åŠ¡å¯¹è±¡
                const newTask = {
                    id: Date.now(), // ä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºå”¯ä¸€ID
                    text: text,     // ä»»åŠ¡å†…å®¹
                    completed: false // åˆå§‹çŠ¶æ€ä¸ºæœªå®Œæˆ
                };
                // å°†æ–°ä»»åŠ¡æ·»åŠ åˆ°æ•°ç»„
                tasks.push(newTask);
                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                this.saveTasks(tasks);
                // è¿”å›æ–°åˆ›å»ºçš„ä»»åŠ¡
                return newTask;
            },
            
            /**
             * åˆ‡æ¢ä»»åŠ¡çš„å®ŒæˆçŠ¶æ€
             * @param {number} id ä»»åŠ¡ID
             * @returns {Object|null} åˆ‡æ¢çŠ¶æ€åçš„ä»»åŠ¡å¯¹è±¡æˆ–null
             */
            toggleTask: function(id) {
                // è·å–ç°æœ‰ä»»åŠ¡
                const tasks = this.getTasks();
                // æŸ¥æ‰¾ä»»åŠ¡åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•
                const taskIndex = tasks.findIndex(task => task.id === id);
                // å¦‚æœæ‰¾åˆ°ä»»åŠ¡
                if (taskIndex !== -1) {
                    // åˆ‡æ¢ä»»åŠ¡çš„completedçŠ¶æ€
                    tasks[taskIndex].completed = !tasks[taskIndex].completed;
                    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                    this.saveTasks(tasks);
                    // è¿”å›æ›´æ–°åçš„ä»»åŠ¡
                    return tasks[taskIndex];
                }
                // æœªæ‰¾åˆ°ä»»åŠ¡ï¼Œè¿”å›null
                return null;
            },
            
            /**
             * åˆ é™¤ä»»åŠ¡
             * @param {number} id ä»»åŠ¡ID
             * @returns {Array} åˆ é™¤ä»»åŠ¡åçš„æ•°ç»„
             */
            deleteTask: function(id) {
                // è·å–ç°æœ‰ä»»åŠ¡
                const tasks = this.getTasks();
                // è¿‡æ»¤æ‰IDåŒ¹é…çš„ä»»åŠ¡
                const updatedTasks = tasks.filter(task => task.id !== id);
                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                this.saveTasks(updatedTasks);
                // è¿”å›æ›´æ–°åçš„ä»»åŠ¡æ•°ç»„
                return updatedTasks;
            },
            
            /**
             * è·å–ä»»åŠ¡ç»Ÿè®¡ä¿¡æ¯
             * @returns {Object} åŒ…å«å·²å®Œæˆä»»åŠ¡æ•°å’Œæ€»ä»»åŠ¡æ•°çš„å¯¹è±¡
             */
            getStats: function() {
                // è·å–ç°æœ‰ä»»åŠ¡
                const tasks = this.getTasks();
                // è®¡ç®—å·²å®Œæˆä»»åŠ¡æ•°é‡
                const completed = tasks.filter(task => task.completed).length;
                // è¿”å›ç»Ÿè®¡ä¿¡æ¯
                return {
                    completed: completed, // å·²å®Œæˆä»»åŠ¡æ•°
                    total: tasks.length    // æ€»ä»»åŠ¡æ•°
                };
            }
        };

        /**
         * DOMæ“ä½œç®¡ç†æ¨¡å—
         * è´Ÿè´£é¡µé¢æ¸²æŸ“å’Œäº‹ä»¶å¤„ç†
         */
        const domManager = {
            /**
             * æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨
             */
            renderTasks: function() {
                // è·å–ä»»åŠ¡åˆ—è¡¨å…ƒç´ 
                const todoList = document.getElementById('todo-list');
                // è·å–æ‰€æœ‰ä»»åŠ¡
                const tasks = taskManager.getTasks();
                
                // æ¸…ç©ºåˆ—è¡¨
                todoList.innerHTML = '';
                
                // éå†ä»»åŠ¡æ•°ç»„ï¼Œæ¸²æŸ“æ¯ä¸ªä»»åŠ¡
                tasks.forEach(task => {
                    // åˆ›å»ºä»»åŠ¡é¡¹å…ƒç´ 
                    const taskItem = this.createTaskItem(task);
                    // æ·»åŠ åˆ°ä»»åŠ¡åˆ—è¡¨
                    todoList.appendChild(taskItem);
                });
                
                // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                this.updateStats();
            },
            
            /**
             * åˆ›å»ºä»»åŠ¡é¡¹å…ƒç´ 
             * @param {Object} task ä»»åŠ¡å¯¹è±¡
             * @returns {HTMLLIElement} ä»»åŠ¡é¡¹DOMå…ƒç´ 
             */
            createTaskItem: function(task) {
                // åˆ›å»ºliå…ƒç´ 
                const li = document.createElement('li');
                // æ·»åŠ ç±»å
                li.className = 'todo-item';
                // å­˜å‚¨ä»»åŠ¡IDåˆ°dataå±æ€§
                li.dataset.id = task.id;
                
                // å¦‚æœä»»åŠ¡å·²å®Œæˆï¼Œæ·»åŠ completedç±»
                if (task.completed) {
                    li.classList.add('completed');
                }
                
                // è®¾ç½®ä»»åŠ¡é¡¹çš„HTMLå†…å®¹
                li.innerHTML = `
                    <div class="task-content">
                        <input type="checkbox" class="task-checkbox" ${task.completed ? 'checked' : ''}>
                        <span class="task-text">${task.text}</span>
                    </div>
                    <button class="delete-btn">åˆ é™¤</button>
                `;
                
                // ä¸ºä»»åŠ¡é¡¹æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                this.addTaskListeners(li);
                
                // è¿”å›åˆ›å»ºçš„ä»»åŠ¡é¡¹å…ƒç´ 
                return li;
            },
            
            /**
             * ä¸ºä»»åŠ¡é¡¹æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
             * @param {HTMLLIElement} taskItem ä»»åŠ¡é¡¹å…ƒç´ 
             */
            addTaskListeners: function(taskItem) {
                // è·å–ä»»åŠ¡é¡¹ä¸­çš„å¤é€‰æ¡†å’Œåˆ é™¤æŒ‰é’®
                const checkbox = taskItem.querySelector('.task-checkbox');
                const deleteBtn = taskItem.querySelector('.delete-btn');
                
                // ä¸ºå¤é€‰æ¡†æ·»åŠ changeäº‹ä»¶ç›‘å¬å™¨ï¼ˆåˆ‡æ¢ä»»åŠ¡çŠ¶æ€ï¼‰
                checkbox.addEventListener('change', () => {
                    // è·å–ä»»åŠ¡ID
                    const taskId = parseInt(taskItem.dataset.id);
                    // åˆ‡æ¢ä»»åŠ¡çŠ¶æ€
                    taskManager.toggleTask(taskId);
                    // é‡æ–°æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨
                    this.renderTasks();
                });
                
                // ä¸ºåˆ é™¤æŒ‰é’®æ·»åŠ clickäº‹ä»¶ç›‘å¬å™¨ï¼ˆåˆ é™¤ä»»åŠ¡ï¼‰
                deleteBtn.addEventListener('click', () => {
                    // è·å–ä»»åŠ¡ID
                    const taskId = parseInt(taskItem.dataset.id);
                    // åˆ é™¤ä»»åŠ¡
                    taskManager.deleteTask(taskId);
                    // æ·»åŠ åˆ é™¤åŠ¨ç”»
                    taskItem.classList.add('fade-out');
                    // åŠ¨ç”»ç»“æŸåé‡æ–°æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨
                    setTimeout(() => {
                        this.renderTasks();
                    }, 300); // 300æ¯«ç§’ï¼Œä¸CSSåŠ¨ç”»æŒç»­æ—¶é—´ä¸€è‡´
                });
            },
            
            /**
             * æ›´æ–°ä»»åŠ¡ç»Ÿè®¡ä¿¡æ¯
             */
            updateStats: function() {
                // è·å–ä»»åŠ¡ç»Ÿè®¡ä¿¡æ¯
                const stats = taskManager.getStats();
                // è·å–ç»Ÿè®¡ä¿¡æ¯å…ƒç´ 
                const statsElement = document.getElementById('task-stats');
                // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯çš„HTMLå†…å®¹
                statsElement.innerHTML = `
                    <div class="task-stats-item task-stats-completed">
                        âœ… å·²å®Œæˆ: ${stats.completed}
                    </div>
                    <div class="task-stats-item task-stats-total">
                        ğŸ“‹ æ€»ä»»åŠ¡: ${stats.total}
                    </div>
                `;
            },
            
            /**
             * åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
             */
            initEventListeners: function() {
                // è·å–æ·»åŠ ä»»åŠ¡æŒ‰é’®å’Œè¾“å…¥æ¡†
                const addTaskBtn = document.getElementById('add-task-btn');
                const taskInput = document.getElementById('task-input');
                
                // ä¸ºæ·»åŠ ä»»åŠ¡æŒ‰é’®æ·»åŠ clickäº‹ä»¶ç›‘å¬å™¨
                addTaskBtn.addEventListener('click', () => {
                    // è·å–è¾“å…¥æ¡†çš„å€¼å¹¶å»é™¤é¦–å°¾ç©ºæ ¼
                    const taskText = taskInput.value.trim();
                    // å¦‚æœè¾“å…¥å†…å®¹ä¸ä¸ºç©º
                    if (taskText) {
                        // æ·»åŠ æ–°ä»»åŠ¡
                        taskManager.addTask(taskText);
                        // é‡æ–°æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨
                        this.renderTasks();
                        // æ¸…ç©ºè¾“å…¥æ¡†
                        taskInput.value = '';
                    }
                });
                
                // ä¸ºè¾“å…¥æ¡†æ·»åŠ keypressäº‹ä»¶ç›‘å¬å™¨ï¼ˆæŒ‰ä¸‹å›è½¦é”®æ·»åŠ ä»»åŠ¡ï¼‰
                taskInput.addEventListener('keypress', (e) => {
                    // å¦‚æœæŒ‰ä¸‹çš„æ˜¯å›è½¦é”®
                    if (e.key === 'Enter') {
                        // è·å–è¾“å…¥æ¡†çš„å€¼å¹¶å»é™¤é¦–å°¾ç©ºæ ¼
                        const taskText = taskInput.value.trim();
                        // å¦‚æœè¾“å…¥å†…å®¹ä¸ä¸ºç©º
                        if (taskText) {
                            // æ·»åŠ æ–°ä»»åŠ¡
                            taskManager.addTask(taskText);
                            // é‡æ–°æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨
                            this.renderTasks();
                            // æ¸…ç©ºè¾“å…¥æ¡†
                            taskInput.value = '';
                        }
                    }
                });
            }
        };

        /**
         * åˆå§‹åŒ–åº”ç”¨
         */
        function initApp() {
            // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
            domManager.initEventListeners();
            // æ¸²æŸ“åˆå§‹ä»»åŠ¡åˆ—è¡¨
            domManager.renderTasks();
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–åº”ç”¨
        // DOMContentLoadedäº‹ä»¶åœ¨DOMæ ‘æ„å»ºå®Œæˆåè§¦å‘
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>